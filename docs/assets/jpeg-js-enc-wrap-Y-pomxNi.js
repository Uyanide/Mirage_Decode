function z0(g){var R=Math.floor,W=new Array(64),Z=new Array(64),j=new Array(64),F=new Array(64),z,J,m,K,Q=new Array(65535),M=new Array(65535),p=new Array(64),V=new Array(64),X=[],Y=0,y=7,x0=new Array(64),r0=new Array(64),a0=new Array(64),P0=new Array(256),b=new Array(2048),v0,E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],f0=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],e0=[0,1,2,3,4,5,6,7,8,9,10,11],n0=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],o0=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],c0=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],i0=[0,1,2,3,4,5,6,7,8,9,10,11],d0=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],u0=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function S0(x){for(var v=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],f=0;f<64;f++){var e=R((v[f]*x+50)/100);e<1?e=1:e>255&&(e=255),W[E[f]]=e}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],o=0;o<64;o++){var i=R((n[o]*x+50)/100);i<1?i=1:i>255&&(i=255),Z[E[o]]=i}for(var c=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],u=0,w=0;w<8;w++)for(var a=0;a<8;a++)j[u]=1/(W[E[u]]*c[w]*c[a]*8),F[u]=1/(Z[E[u]]*c[w]*c[a]*8),u++}function O(x,v){for(var f=0,e=0,n=new Array,o=1;o<=16;o++){for(var i=1;i<=x[o];i++)n[v[e]]=[],n[v[e]][0]=f,n[v[e]][1]=o,e++,f++;f*=2}return n}function G0(){z=O(f0,e0),J=O(c0,i0),m=O(n0,o0),K=O(d0,u0)}function L0(){for(var x=1,v=2,f=1;f<=15;f++){for(var e=x;e<v;e++)M[32767+e]=f,Q[32767+e]=[],Q[32767+e][1]=f,Q[32767+e][0]=e;for(var n=-(v-1);n<=-x;n++)M[32767+n]=f,Q[32767+n]=[],Q[32767+n][1]=f,Q[32767+n][0]=v-1+n;x<<=1,v<<=1}}function N0(){for(var x=0;x<256;x++)b[x]=19595*x,b[x+256>>0]=38470*x,b[x+512>>0]=7471*x+32768,b[x+768>>0]=-11059*x,b[x+1024>>0]=-21709*x,b[x+1280>>0]=32768*x+8421375,b[x+1536>>0]=-27439*x,b[x+1792>>0]=-5329*x}function D(x){for(var v=x[0],f=x[1]-1;f>=0;)v&1<<f&&(Y|=1<<y),f--,y--,y<0&&(Y==255?(r(255),r(0)):r(Y),y=7,Y=0)}function r(x){X.push(x)}function d(x){r(x>>8&255),r(x&255)}function R0(x,v){var f,e,n,o,i,c,u,w,a=0,s,t=8,U=64;for(s=0;s<t;++s){f=x[a],e=x[a+1],n=x[a+2],o=x[a+3],i=x[a+4],c=x[a+5],u=x[a+6],w=x[a+7];var l=f+w,_=f-w,A=e+u,T=e-u,h=n+c,C=n-c,_0=o+i,q0=o-i,H=l+_0,B=l-_0,P=A+h,S=A-h;x[a]=H+P,x[a+4]=H-P;var s0=(S+B)*.707106781;x[a+2]=B+s0,x[a+6]=B-s0,H=q0+C,P=C+T,S=T+_;var b0=(H-S)*.382683433,h0=.5411961*H+b0,l0=1.306562965*S+b0,t0=P*.707106781,A0=_+t0,T0=_-t0;x[a+5]=T0+h0,x[a+3]=T0-h0,x[a+1]=A0+l0,x[a+7]=A0-l0,a+=8}for(a=0,s=0;s<t;++s){f=x[a],e=x[a+8],n=x[a+16],o=x[a+24],i=x[a+32],c=x[a+40],u=x[a+48],w=x[a+56];var y0=f+w,k=f-w,D0=e+u,U0=e-u,C0=n+c,Q0=n-c,V0=o+i,j0=o-i,I=y0+V0,q=y0-V0,G=D0+C0,L=D0-C0;x[a]=I+G,x[a+32]=I-G;var Y0=(L+q)*.707106781;x[a+16]=q+Y0,x[a+48]=q-Y0,I=j0+Q0,G=Q0+U0,L=U0+k;var g0=(I-L)*.382683433,E0=.5411961*I+g0,H0=1.306562965*L+g0,I0=G*.707106781,M0=k+I0,O0=k-I0;x[a+40]=O0+E0,x[a+24]=O0-E0,x[a+8]=M0+H0,x[a+56]=M0-H0,a++}var N;for(s=0;s<U;++s)N=x[s]*v[s],p[s]=N>0?N+.5|0:N-.5|0;return p}function W0(){d(65504),d(16),r(74),r(70),r(73),r(70),r(0),r(1),r(1),r(0),d(1),d(1),r(0),r(0)}function Z0(x){if(x){d(65505),x[0]===69&&x[1]===120&&x[2]===105&&x[3]===102?d(x.length+2):(d(x.length+5+2),r(69),r(120),r(105),r(102),r(0));for(var v=0;v<x.length;v++)r(x[v])}}function F0(x,v){d(65472),d(17),r(8),d(v),d(x),r(3),r(1),r(17),r(0),r(2),r(17),r(1),r(3),r(17),r(1)}function J0(){d(65499),d(132),r(0);for(var x=0;x<64;x++)r(W[x]);r(1);for(var v=0;v<64;v++)r(Z[v])}function K0(){d(65476),d(418),r(0);for(var x=0;x<16;x++)r(f0[x+1]);for(var v=0;v<=11;v++)r(e0[v]);r(16);for(var f=0;f<16;f++)r(n0[f+1]);for(var e=0;e<=161;e++)r(o0[e]);r(1);for(var n=0;n<16;n++)r(c0[n+1]);for(var o=0;o<=11;o++)r(i0[o]);r(17);for(var i=0;i<16;i++)r(d0[i+1]);for(var c=0;c<=161;c++)r(u0[c])}function X0(x){typeof x>"u"||x.constructor!==Array||x.forEach(v=>{if(typeof v=="string"){d(65534);var f=v.length;d(f+2);var e;for(e=0;e<f;e++)r(v.charCodeAt(e))}})}function $0(){d(65498),d(12),r(3),r(1),r(0),r(2),r(17),r(3),r(17),r(0),r(63),r(0)}function $(x,v,f,e,n){for(var o=n[0],i=n[240],c,u=16,w=63,a=64,s=R0(x,v),t=0;t<a;++t)V[E[t]]=s[t];var U=V[0]-f;f=V[0],U==0?D(e[0]):(c=32767+U,D(e[M[c]]),D(Q[c]));for(var l=63;l>0&&V[l]==0;l--);if(l==0)return D(o),f;for(var _=1,A;_<=l;){for(var T=_;V[_]==0&&_<=l;++_);var h=_-T;if(h>=u){A=h>>4;for(var C=1;C<=A;++C)D(i);h=h&15}c=32767+V[_],D(n[(h<<4)+M[c]]),D(Q[c]),_++}return l!=w&&D(o),f}function B0(){for(var x=String.fromCharCode,v=0;v<256;v++)P0[v]=x(v)}this.encode=function(x,v){new Date().getTime(),v&&w0(v),X=new Array,Y=0,y=7,d(65496),W0(),X0(x.comments),Z0(x.exifBuffer),J0(),F0(x.width,x.height),K0(),$0();var f=0,e=0,n=0;Y=0,y=7,this.encode.displayName="_encode_";for(var o=x.data,i=x.width,c=x.height,u=i*4,w,a=0,s,t,U,l,_,A,T,h;a<c;){for(w=0;w<u;){for(l=u*a+w,_=l,A=-1,T=0,h=0;h<64;h++)T=h>>3,A=(h&7)*4,_=l+T*u+A,a+T>=c&&(_-=u*(a+1+T-c)),w+A>=u&&(_-=w+A-u+4),s=o[_++],t=o[_++],U=o[_++],x0[h]=(b[s]+b[t+256>>0]+b[U+512>>0]>>16)-128,r0[h]=(b[s+768>>0]+b[t+1024>>0]+b[U+1280>>0]>>16)-128,a0[h]=(b[s+1280>>0]+b[t+1536>>0]+b[U+1792>>0]>>16)-128;f=$(x0,j,f,z,m),e=$(r0,F,e,J,K),n=$(a0,F,n,J,K),w+=32}a+=8}if(y>=0){var C=[];C[1]=y+1,C[0]=(1<<y+1)-1,D(C)}return d(65497),new Uint8Array(X)};function w0(x){if(x<=0&&(x=1),x>100&&(x=100),v0!=x){var v=0;x<50?v=Math.floor(5e3/x):v=Math.floor(200-x*2),S0(v),v0=x}}function k0(){var x=new Date().getTime();g||(g=50),B0(),G0(),L0(),N0(),w0(g),new Date().getTime()-x}k0()}function m0(g){return new z0(100).encode(g)}export{m0 as encode};
