import{i as _,k as q,r as x,l as le,j as n,n as T,o as A,p as J,q as ce,t as de,v as ue,w as Se,x as E,y as X,z as De,A as ze,C as he,F as xe,E as g,h as B,m as N,g as fe,B as p,b as F,G as ke,T as k,c as Fe,H as Ge,a as Me,f as Y,I as Pe,e as ee}from"./index-BEPoz5Rf.js";import{u as pe,f as Te,g as Ee,h as Be,a as M,b as me,n as P,C as ge,c as ve,i as Ne,H as D,P as We,F as $e,I as Ue,S as W,d as se,j as Oe,k as H}from"./format-selector-Cgg54ShH.js";import{S as Le,G as V,N as He,a as Ce,u as te,F as Ve,b as ne}from"./format-warn-dialog-DUC5fxQB.js";function _e(s){return _("MuiFormGroup",s)}q("MuiFormGroup",["root","row","error"]);const qe=s=>{const{classes:e,row:t,error:a}=s;return J({root:["root",t&&"row",a&&"error"]},_e,e)},Ae=T("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(s,e)=>{const{ownerState:t}=s;return[e.root,t.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),Je=x.forwardRef(function(e,t){const a=le({props:e,name:"MuiFormGroup"}),{className:r,row:c=!1,...d}=a,o=pe(),h=Te({props:a,muiFormControl:o,states:["error"]}),b={...a,row:c,error:h.error},I=qe(b);return n.jsx(Ae,{className:A(I.root,r),ownerState:b,ref:t,...d})}),Ze=ce(n.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Ke=ce(n.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),Qe=T("span",{name:"MuiRadioButtonIcon",shouldForwardProp:de})({position:"relative",display:"flex"}),Xe=T(Ze,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),Ye=T(Ke,{name:"MuiRadioButtonIcon"})(ue(({theme:s})=>({left:0,position:"absolute",transform:"scale(0)",transition:s.transitions.create("transform",{easing:s.transitions.easing.easeIn,duration:s.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:s.transitions.create("transform",{easing:s.transitions.easing.easeOut,duration:s.transitions.duration.shortest})}}]})));function be(s){const{checked:e=!1,classes:t={},fontSize:a}=s,r={...s,checked:e};return n.jsxs(Qe,{className:t.root,ownerState:r,children:[n.jsx(Xe,{fontSize:a,className:t.background,ownerState:r}),n.jsx(Ye,{fontSize:a,className:t.dot,ownerState:r})]})}const je=x.createContext(void 0);function es(){return x.useContext(je)}function ss(s){return _("MuiRadio",s)}const ae=q("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),ts=s=>{const{classes:e,color:t,size:a}=s,r={root:["root",`color${E(t)}`,a!=="medium"&&`size${E(a)}`]};return{...e,...J(r,ss,e)}},ns=T(Le,{shouldForwardProp:s=>de(s)||s==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(s,e)=>{const{ownerState:t}=s;return[e.root,t.size!=="medium"&&e[`size${E(t.size)}`],e[`color${E(t.color)}`]]}})(ue(({theme:s})=>({color:(s.vars||s).palette.text.secondary,[`&.${ae.disabled}`]:{color:(s.vars||s).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:s.alpha((s.vars||s).palette.action.active,(s.vars||s).palette.action.hoverOpacity)}}},...Object.entries(s.palette).filter(X()).map(([e])=>({props:{color:e,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:s.alpha((s.vars||s).palette[e].main,(s.vars||s).palette.action.hoverOpacity)}}})),...Object.entries(s.palette).filter(X()).map(([e])=>({props:{color:e,disabled:!1},style:{[`&.${ae.checked}`]:{color:(s.vars||s).palette[e].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function as(s,e){return typeof e=="object"&&e!==null?s===e:String(s)===String(e)}const os=n.jsx(be,{checked:!0}),rs=n.jsx(be,{}),oe=x.forwardRef(function(e,t){const a=le({props:e,name:"MuiRadio"}),{checked:r,checkedIcon:c=os,color:d="primary",icon:o=rs,name:h,onChange:b,size:I="medium",className:j,disabled:l,disableRipple:y=!1,slots:C={},slotProps:i={},inputProps:m,...v}=a,f=pe();let w=l;f&&typeof w>"u"&&(w=f.disabled),w??=!1;const S={...a,disabled:w,disableRipple:y,color:d,size:I},z=ts(S),G=es();let U=r;const ye=Ee(b,G&&G.onChange);let O=h;G&&(typeof U>"u"&&(U=as(G.value,a.value)),typeof O>"u"&&(O=G.name));const L=i.input??m,[Re,we]=Se("root",{ref:t,elementType:ns,className:A(z.root,j),shouldForwardComponentProp:!0,externalForwardedProps:{slots:C,slotProps:i,...v},getSlotProps:Z=>({...Z,onChange:(K,...Q)=>{Z.onChange?.(K,...Q),ye(K,...Q)}}),ownerState:S,additionalProps:{type:"radio",icon:x.cloneElement(o,{fontSize:o.props.fontSize??I}),checkedIcon:x.cloneElement(c,{fontSize:c.props.fontSize??I}),disabled:w,name:O,checked:U,slots:C,slotProps:{input:typeof L=="function"?L(S):L}}});return n.jsx(Re,{...we,classes:z})});function is(s){return _("MuiRadioGroup",s)}q("MuiRadioGroup",["root","row","error"]);const ls=s=>{const{classes:e,row:t,error:a}=s;return J({root:["root",t&&"row",a&&"error"]},is,e)},cs=x.forwardRef(function(e,t){const{actions:a,children:r,className:c,defaultValue:d,name:o,onChange:h,value:b,...I}=e,j=x.useRef(null),l=ls(e),[y,C]=Be({controlled:b,default:d,name:"RadioGroup"});x.useImperativeHandle(a,()=>({focus:()=>{let f=j.current.querySelector("input:not(:disabled):checked");f||(f=j.current.querySelector("input:not(:disabled)")),f&&f.focus()}}),[]);const i=De(t,j),m=ze(o),v=x.useMemo(()=>({name:m,onChange(f){C(f.target.value),h&&h(f,f.target.value)},value:y}),[m,h,C,y]);return n.jsx(je.Provider,{value:v,children:n.jsx(Je,{role:"radiogroup",ref:i,className:A(l.root,c),...I,children:r})})});function Ie(s,e,t,a,r){return t===0?(r?e:s)%(a+1)<a:r?(e/t+s)%(a+1)<a:(s/t+e)%(a+1)<a}function ds(s,e,t,{innerThreshold:a,coverThreshold:r,slope:c,gap:d,isRow:o,isReverse:h}){const b=(i,m)=>Ie(i,m,c,d,o),I=(i,m,v)=>Math.floor(v(i,m)),j=(i,m)=>I(i,m,h?(v,f)=>255-f+v*f/255:(v,f)=>v*f/255),l=(i,m)=>I(i,m,h?(v,f)=>v*(255-f)/255:(v,f)=>f+v*(255-f)/255),y=s.width,C=s.data.length;for(let i=0,m=0,v=0;i<C;i+=4){if(b(m,v)){const f=e.data[i],w=e.data[i+1],S=e.data[i+2],z=e.data[i+3];t.data[i]=l(f,r),t.data[i+1]=l(w,r),t.data[i+2]=l(S,r),t.data[i+3]=z}else{const f=s.data[i],w=s.data[i+1],S=s.data[i+2],z=s.data[i+3];t.data[i]=j(f,a),t.data[i+1]=j(w,a),t.data[i+2]=j(S,a),t.data[i+3]=z}m+=1,m>=y&&(m=0,v+=1)}}function us(s,e,t){return e=M.scaleContrastCompress(e),`${t?"1":"0"}${s.toString(16).padStart(2,"0")}${e.toString(16).padStart(2,"0")}`}class re extends me{resizedData=P();adjustedData=P();isInner;constructor(e){super(),this.isInner=e}bind(e){super.bind(e)}resizeFit(){if(!this.srcData.v)return;const{maxSize:e}=u.getState();M.resizeFit(e,this.srcData,this.resizedData)}resizeCover(e,t){this.srcData.v&&M.resizeCover(e,t,this.srcData,this.resizedData)}getSize(){return{width:this.resizedData.v?.width??0,height:this.resizedData.v?.height??0}}adjust(){if(!this.resizedData.v)return;let e,t;this.isInner?(e=u.getState().isInnerGray,t=u.getState().innerContrast):(e=u.getState().isCoverGray,t=u.getState().coverContrast);const a=P();e?M.toGray(this.resizedData,a):a.v=this.resizedData.v;const r=P();t!==0?M.adjustContrast(t,a,r):r.v=a.v,this.adjustedData.v=r.v}}class hs extends me{inner=new re(!0);cover=new re(!1);resultData=P();bind(e){super.bind(e),this.subscribe(u.subscribe(t=>t.maxSize,()=>{this.resize(),this.encodeResult()})),this.subscribe(u.subscribe(t=>t.innerContrast,()=>{this.inner.adjust(),this.inner.putImageData(this.inner.adjustedData),this.encodeResult()})),this.subscribe(u.subscribe(t=>t.coverContrast,()=>{this.cover.adjust(),this.cover.putImageData(this.cover.adjustedData),this.encodeResult()})),this.subscribe(u.subscribe(t=>t.isInnerGray,()=>{this.inner.adjust(),this.inner.putImageData(this.inner.adjustedData),this.encodeResult()})),this.subscribe(u.subscribe(t=>t.isCoverGray,()=>{this.cover.adjust(),this.cover.putImageData(this.cover.adjustedData),this.encodeResult()})),this.subscribe(u.subscribe(t=>t.blendMode,()=>{this.encodeResult()})),this.subscribe(u.subscribe(t=>t.innerThreshold,()=>{this.encodeResult()})),this.subscribe(u.subscribe(t=>t.coverThreshold,()=>{this.encodeResult()})),this.subscribe(u.subscribe(t=>t.isReverse,()=>{this.encodeResult()})),this.resize(),this.encodeResult()}unbind(){super.unbind()}setInnerImage(e){this.inner.setImage(e,!1),this.resize(),this.cover.hasImage()&&this.encodeResult()}setCoverImage(e){if(this.cover.setImage(e,!1),!this.inner.hasImage()){this.cover.putImageData(this.cover.srcData);return}this.resize(),this.encodeResult()}resize(){if(!this.inner.hasImage()||(this.inner.resizeFit(),this.inner.adjust(),this.inner.putImageData(this.inner.adjustedData),!this.cover.hasImage()))return;const{width:e,height:t}=this.inner.getSize();this.cover.resizeCover(e,t),this.cover.adjust(),this.cover.putImageData(this.cover.adjustedData)}bindInner=e=>{this.inner.bind(e)};bindCover=e=>{this.cover.bind(e)};unbindInner=()=>{this.inner.unbind()};unbindCover=()=>{this.cover.unbind()};encodeResult(){const e=this.inner.adjustedData.v,t=this.cover.adjustedData.v;if(!e||!t||e.width!==t.width||e.height!==t.height)return;(!this.resultData.v||this.resultData.v.width!==e.width||this.resultData.v.height!==e.height)&&(this.resultData.v=new ImageData(e.width,e.height));const a=this.resultData.v,{innerThreshold:r,coverThreshold:c,blendMode:{slope:d,gap:o,isRow:h},isReverse:b}=u.getState();ds(e,t,a,{innerThreshold:r,coverThreshold:c,slope:d,gap:o,isRow:h,isReverse:b}),this.resultData.v=a,$.getState().haveResult=!0,this.putImageData(this.resultData)}async saveResult(e){const t=await this.encodeImageFile(this.resultData,e);return this.saveImageFile(t,e)}encodeResultToFile(e){const{innerThreshold:t,innerContrast:a,isReverse:r}=u.getState(),c=us(t,a,r);return this.encodeImageFile(this.resultData,e,c)}}const R=new hs,u=he()(xe(s=>({innerThreshold:g.innerThreshold,coverThreshold:g.coverThreshold,innerContrast:g.innerContrast,coverContrast:g.coverContrast,isInnerGray:g.isInnerGray,isCoverGray:g.isCoverGray,isReverse:g.isReverse,saveFormat:g.saveFormat,maxSize:g.maxSize,blendMode:{slope:g.blendMode.slope,gap:g.blendMode.gap,isRow:g.blendMode.isRow},setInnerThreshold:e=>{s(t=>e>t.coverThreshold||e<0?{}:{innerThreshold:e})},setCoverThreshold:e=>{s(t=>e<t.innerThreshold||e>255?{}:{coverThreshold:e})},setInnerContrast:e=>{e<B||e>N||s({innerContrast:e})},setCoverContrast:e=>{e<B||e>N||s({coverContrast:e})},setIsInnerGray:e=>{s({isInnerGray:e})},setIsCoverGray:e=>{s({isCoverGray:e})},setIsReverse:e=>{s({isReverse:e})},setSaveFormat:e=>{s({saveFormat:e})},setMaxSize:e=>{e<g.minMaxSize||e>g.maxMaxSize||s({maxSize:e})},setBlendMode:(e,t,a)=>{s({blendMode:{slope:e,gap:t,isRow:a}})}}))),$=he()(xe(s=>({innerImage:null,coverImage:null,haveResult:!1,setInnerImage:e=>{e&&R.setInnerImage(e),s({innerImage:e})},setCoverImage:e=>{e&&R.setCoverImage(e),s({coverImage:e})},setHaveResult:e=>{s({haveResult:e})}})));function Ss(){const s=fe();return n.jsxs(p,{sx:{display:"flex",flexDirection:"column",width:"100%",maxWidth:s?"lg":"sm",mx:"auto"},children:[n.jsx(xs,{}),n.jsxs(p,{sx:{display:"flex",flexDirection:s?"row":"column",mt:2,gap:2},children:[n.jsx(gs,{}),n.jsx(ms,{})]})]})}function xs(){const s=fe();return n.jsxs(V,{container:!0,spacing:2,children:[n.jsx(V,{size:s?6:12,children:n.jsx(ie,{isCover:!1})}),n.jsx(V,{size:s?6:12,children:n.jsx(ie,{isCover:!0})})]})}function ie({isCover:s}){return n.jsx(ve,{children:n.jsxs(p,{sx:{display:"flex",flexDirection:"row",width:"100%",gap:2,alignItems:"center"},children:[n.jsx(fs,{isCover:s}),n.jsx(ps,{isCover:s})]})})}function fs({isCover:s}){const e=$(s?d=>d.coverImage:d=>d.innerImage),t=$(s?d=>d.setCoverImage:d=>d.setInnerImage),a=x.useRef(null),c=Pe()?120:200;return x.useEffect(()=>{const d=a.current;if(d)return s?R.bindCover(d):R.bindInner(d),()=>{s?R.unbindCover():R.unbindInner()}}),n.jsxs(p,{sx:{display:"flex",flexDirection:"column",gap:1,px:1,width:c},children:[n.jsx(Ue,{onconfirm:d=>{t(d)},defaultImage:s?ee.encodeCover:ee.encodeInner,label:"加载"}),!e&&n.jsx(ge,{text:"(･_･`)>",aspectRatio:"1",styles:{width:"100%",objectFit:"contain"}}),n.jsx("canvas",{ref:a,style:{maxWidth:c,maxHeight:c,display:e?"block":"none",objectFit:"contain"}})]})}function ps({isCover:s}){const e=u(s?o=>o.coverThreshold:o=>o.innerThreshold),t=u(s?o=>o.coverContrast:o=>o.innerContrast),a=u(s?o=>o.isCoverGray:o=>o.isInnerGray),r=u(s?o=>o.setCoverThreshold:o=>o.setInnerThreshold),c=u(s?o=>o.setCoverContrast:o=>o.setInnerContrast),d=u(s?o=>o.setIsCoverGray:o=>o.setIsInnerGray);return n.jsxs(p,{sx:{flex:1,display:"flex",flexDirection:"column"},children:[n.jsx(k,{variant:"subtitle1",color:"primary",children:s?"表图设置":"里图设置"}),n.jsxs(p,{sx:{mt:1,display:"flex",flexDirection:"row",alignItems:"center"},children:[n.jsx(k,{variant:"body2",children:"1. 色阶端点:"}),n.jsx(p,{sx:{flex:1}}),n.jsx(D,{message:s?"越高显形效果越好":"越低隐藏效果越好"})]}),n.jsx(W,{value:e,min:0,max:255,step:g.thresholdStep,track:s?"inverted":"normal",onChange:(o,h)=>{r(h)},valueLabelDisplay:"auto"}),n.jsx(p,{sx:{display:"flex",flexDirection:"row",gap:1},children:n.jsx(se,{value:e,inputProps:{step:g.thresholdStep,min:0,max:255,type:"number"},sx:{width:"80px"},onChange:o=>{const h=parseInt(o.target.value,10);isNaN(h)||r(h)}})}),n.jsxs(p,{sx:{mt:1,display:"flex",flexDirection:"row",alignItems:"center"},children:[n.jsx(k,{variant:"body2",children:"2. 对比度:"}),n.jsx(p,{sx:{flex:1}}),n.jsx(D,{message:"不合理的对比度会严重降低显形质量"})]}),n.jsx(W,{value:t,min:B,max:N,step:g.contrastStep,onChange:(o,h)=>{c(h)},valueLabelDisplay:"auto"}),n.jsxs(p,{sx:{display:"flex",flexDirection:"row",gap:1},children:[n.jsx(se,{value:t,inputProps:{step:g.contrastStep,min:B,max:N,type:"number"},sx:{width:"80px"},onChange:o=>{const h=parseInt(o.target.value,10);isNaN(h)||c(h)}}),n.jsx(F,{size:"small",sx:{width:"80px"},onClick:()=>{c(s?g.coverContrast:g.innerContrast)},children:"重置对比度"})]}),n.jsxs(p,{sx:{mt:1,display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[n.jsx(k,{variant:"body2",children:"3. 取灰度:"}),n.jsx(Ce,{size:"medium",checked:a,onChange:o=>{d(o.target.checked)}}),n.jsx(p,{sx:{flex:1}}),n.jsx(D,{message:"舍弃颜色可显著提升抗压缩能力"})]}),n.jsx(p,{sx:{mt:1,display:"flex",flexDirection:"row",alignItems:"center",gap:1}})]})}function ms(){return n.jsxs(p,{sx:{display:"flex",flexDirection:"column",width:"100%",gap:2},children:[n.jsx(ve,{children:n.jsxs(p,{sx:{display:"flex",flexDirection:"column",gap:2,width:"100%"},children:[n.jsx(vs,{}),n.jsx(bs,{}),n.jsx(js,{})]})}),n.jsx(Is,{})]})}function gs(){const s=x.useRef(null),e=$(t=>t.haveResult);return x.useEffect(()=>{const t=s.current;if(t)return R.bind(t),()=>{R.unbind()}},[]),n.jsxs(n.Fragment,{children:[!e&&n.jsx(ge,{text:"只是一张画布",styles:{width:"100%"}}),n.jsx("canvas",{ref:s,style:{width:"100%",display:e?"block":"none"}})]})}function vs(){const[s,e]=x.useState(!1),t=u(c=>c.setBlendMode),a=x.useCallback((c,d,o)=>{t(c,d,o),e(!1),R.encodeResult()},[t]),r=x.useCallback(()=>{e(!1)},[]);return n.jsxs(n.Fragment,{children:[n.jsx(F,{variant:"contained",onClick:()=>{e(!0)},children:"设置混合模式"}),n.jsx(Ne,{open:s,maxWidth:"sm",fullWidth:!0,sx:{zIndex:ke.dialog},children:n.jsx(Cs,{onConfirm:a,onCancel:r})})]})}function Cs({onConfirm:s,onCancel:e}){const t=u(j=>j.blendMode),[a,r]=x.useState(t.slope),[c,d]=x.useState(t.gap),[o,h]=x.useState(t.isRow),b=x.useRef(null),I=x.useCallback((j,l,y)=>{const C=b.current;if(!C)return;C.width=8,C.height=8;const i=C.getContext("2d");if(i){i.imageSmoothingEnabled=!1;for(let m=0;m<C.width;m++)for(let v=0;v<C.height;v++)Ie(m,v,j,l,y)?i.fillStyle="white":i.fillStyle="black",i.fillRect(m,v,1,1)}},[]);return x.useEffect(()=>{I(a,c,o)},[a,c,o,I]),n.jsxs(p,{sx:{display:"flex",flexDirection:"column",padding:2,backgroundColor:"background.paper"},children:[n.jsx("canvas",{ref:b,style:{width:"100%",aspectRatio:"1",imageRendering:"pixelated",padding:"16px"}}),n.jsx(p,{sx:{display:"flex",flexDirection:"column",px:2},children:n.jsxs(Oe,{children:[n.jsx(H,{children:"1. 斜率"}),n.jsx(W,{value:a,min:0,max:4,step:1,onChange:(j,l)=>{r(l)},valueLabelDisplay:"auto",marks:!0}),n.jsxs(p,{sx:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center",justifyContent:"space-between"},children:[n.jsx(H,{children:"2. 间距"}),n.jsx(D,{message:"间距越大，隐藏效果越好，但显形效果越差"})]}),n.jsx(W,{value:c,min:1,max:4,step:1,onChange:(j,l)=>{d(l)},valueLabelDisplay:"auto",marks:!0}),n.jsx(H,{children:"3. 方向"}),n.jsxs(cs,{value:o?"row":"column",row:!0,onChange:(j,l)=>{h(l==="row")},children:[n.jsx(ne,{value:"row",control:n.jsx(oe,{}),label:"这样"}),n.jsx(ne,{value:"column",control:n.jsx(oe,{}),label:"或者这样"})]})]})}),n.jsxs(p,{sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:1},children:[n.jsx(F,{variant:"text",onClick:e,children:"取消"}),n.jsx(p,{sx:{flex:1}}),n.jsx(F,{variant:"text",onClick:()=>{s(a,c,o)},color:"success",children:"确认"})]})]})}function bs(){const s=u(t=>t.maxSize),e=u(t=>t.setMaxSize);return n.jsxs(p,{sx:{display:"flex",flexDirection:"row",alignItems:"end",justifyContent:"center",width:"100%",gap:1},children:[n.jsx(k,{children:"最大长或宽:"}),n.jsx(He,{initValue:s,onChange:t=>{e(t)},size:"small",variant:"standard",sx:{maxWidth:"100px"},min:g.minMaxSize,max:g.maxMaxSize}),n.jsx(D,{message:"此选项用于限制生成图像文件的大小"})]})}function js(){const s=u(t=>t.isReverse),e=u(t=>t.setIsReverse);return n.jsxs(p,{sx:{display:"flex",flexDirection:"row",alignItems:"end",justifyContent:"center",width:"100%",gap:1},children:[n.jsx(k,{variant:"body1",children:"是否反向:"}),n.jsx(Ce,{size:"small",checked:s,onChange:t=>{e(t.target.checked)}}),n.jsx(D,{message:"“反向”即表图更暗 & 里图更亮的模式"})]})}function Is(){const s=u(l=>l.saveFormat),e=u(l=>l.setSaveFormat),t=te(l=>l.showWarning),a=te(l=>l.setShowWarning),[r,c]=x.useState(!1),d=Fe(l=>l.setImages),o=Ge(l=>l.setCurrentRoute),[h,b]=x.useState(!1),I=x.useCallback((l,y)=>{if(!y&&l!=="JPEG"&&t){c(!0);return}b(!0),R.saveResult(l).then(C=>{Me(`已保存为 ${C}`)}).catch(C=>{console.error("Failed to save result:",C),Y("保存失败")}).finally(()=>{b(!1)})},[t]),j=x.useCallback(l=>{b(!0),(async()=>{const y=await R.encodeResultToFile(l),C=await We.fromFileData(y);d([C]),o("/decode")})().catch(y=>{console.error("Failed to encode result:",y),Y("跳转失败")}).finally(()=>{b(!1)})},[d,o]);return n.jsxs(p,{sx:{width:"100%",display:"flex",flexDirection:"row",gap:1},children:[n.jsx(Ve,{show:r,setShow:c,saveFormat:s,handleSave:I,showWarning:t,setShowWarning:a}),n.jsx(F,{sx:{flex:1},variant:"contained",onClick:()=>{I(s,!1)},disabled:h,children:"保存结果"}),n.jsx(F,{sx:{flex:1},variant:"contained",color:"secondary",onClick:()=>{j(s)},disabled:h,children:"显形测试"}),n.jsx($e,{format:s,onChange:l=>{e(l)},disabled:h}),n.jsx(D,{message:"非 JPEG 格式有较高地被社交平台强制压缩的风险"})]})}export{Ss as default};
